afterEvaluate {
    tasks.withType(PublishToMavenRepository) {
        onlyIf {
            ((repository == publishing.repositories.nexusSnapshots) &&
                    (publication == publishing.publications.nexusSnapshots) &&
                    (rootProject.isSnapshotVersion() == true)) ||

                    ((repository == publishing.repositories.nexusReleases) &&
                            (publication == publishing.publications.nexusReleases) &&
                            (rootProject.isSnapshotVersion() == false)) ||

                    ((repository == publishing.repositories.packagecloud) &&
                            (publication == publishing.publications.packagecloud) &&
                            (rootProject.isSnapshotVersion() == false))
        }
    }
    publishing {
        publications {
            nexusSnapshots(MavenPublication) {
                from components.release
                groupId = 'com.payoneer'
                artifactId = 'checkout-android'
                version = versionName
            }
            nexusReleases(MavenPublication) {
                from components.release
                groupId = 'com.payoneer'
                artifactId = 'checkout-android'
                version = versionName
            }
            packagecloud(MavenPublication) {
                from components.release
                groupId = 'com.payoneer'
                artifactId = 'checkout-android'
                version = versionName
            }
        }
        repositories {
            maven {
                name 'nexusSnapshots'
                url 'https://nexus.mgmt.oscato.com/repository/snapshots/'
                credentials {
                    username = rootProject.nexusUser
                    password = rootProject.nexusPassword
                }
            }
            maven {
                name 'nexusReleases'
                url 'https://nexus.mgmt.oscato.com/repository/releases/'
                credentials {
                    username = rootProject.nexusUser
                    password = rootProject.nexusPassword
                }
            }
            maven {
                name = 'packagecloud'
                url = 'https://packagecloud.io/optile/android/java/maven2/'
                credentials {
                    username = rootProject.packageCloudToken
                    password = ''
                }
            }
        }
    }
}
