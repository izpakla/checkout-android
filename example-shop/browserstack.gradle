/*
 * Gradle file with tasks for uploading the ExampleShop app to Browserstack
 */

task deleteFromAppLive {
    if (rootProject.browserStackUser == null || rootProject.browserStackKey == null) {
        logger.lifecycle('[BROWSERSTACK] Missing credentials')
        return
    }
    doLast {
        rootProject.deleteAppLiveWithCustomId("ExampleShop-${getBranchName()}")
    }
}

task uploadToAppLive {
    if (rootProject.browserStackUser == null || rootProject.browserStackKey == null) {
        logger.lifecycle('[BROWSERSTACK] Missing credentials')
        return
    }
    dependsOn('uploadExampleShopDebugToBrowserstackAppLive')
}

task testOnAppAutomate {
    if ((rootProject.merchantCode == null) || (rootProject.merchantPaymentToken == null) ||
            (rootProject.paymentApiListUrl == null)) {
        logger.lifecycle('[BROWSERSTACK] Missing functional test settings')
        return
    }
    if (rootProject.browserStackUser == null || rootProject.browserStackKey == null) {
        logger.lifecycle('[BROWSERSTACK] Missing credentials')
        return
    }
    dependsOn('executeExampleShopDebugTestsOnBrowserstack')
}

browserStackConfig {
    username = rootProject.browserStackUser
    accessKey = rootProject.browserStackKey
    customId = "ExampleShop-${getBranchName()}"
    configFilePath = 'example-shop/browserstack.json'
}